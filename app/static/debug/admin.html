<!DOCTYPE html>
<html lang="zh-CN" class="">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç®¡ç†åå° - </title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css">
    <link rel="stylesheet" href="/static/css/admin.css">
    <!-- æš—é»‘æ¨¡å¼æ ·å¼è¡¨ -->
    <link href="/static/css/themes/dark.css" rel="stylesheet">
    <style>
        body {
            padding-top: 20px;
        }
        .flash-messages {
            margin-bottom: 20px;
        }
        
        /* ä¾§è¾¹æ æ ·å¼ */
        @media (max-width: 767.98px) {
            .sidebar {
                position: fixed;
                top: 0;
                bottom: 0;
                left: 0;
                z-index: 100;
                padding: 0;
                width: 250px;
                transform: translateX(-100%);
                transition: transform 0.3s ease-in-out;
            }
            
            .sidebar.show {
                transform: translateX(0);
            }
            
            .sidebar-backdrop {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background-color: rgba(0, 0, 0, 0.5);
                z-index: 99;
                display: none;
            }
            
            .sidebar-backdrop.show {
                display: block;
            }
        }
    </style>
    
<link rel="stylesheet" href="/static/css/admin-dashboard.css">
<style>
    .stats-card {
        transition: transform 0.3s;
        min-height: 150px;
        display: flex;
        flex-direction: column;
        justify-content: center;
    }
    .stats-card:hover {
        transform: translateY(-5px);
    }
    .card-icon {
        font-size: 2rem;
        margin-bottom: 10px;
    }
    .quick-actions a {
        text-decoration: none;
    }
    .card-body {
        padding: 1.25rem;
    }
    .stats-card h2 {
        font-size: 2.5rem;
        margin-top: 10px;
        margin-bottom: 0;
    }
    .stats-card h5 {
        margin-bottom: 0;
    }
    /* ç¡®ä¿å¡ç‰‡å†…å®¹å¯è§ */
    .bg-primary, .bg-success, .bg-warning, .bg-info {
        color: white !important;
    }
    .text-white {
        color: white !important;
    }
    /* æš—é»‘æ¨¡å¼æ ·å¼è°ƒæ•´ */
    .dark-theme .card {
        background-color: var(--card-bg);
        border-color: var(--border-color);
    }
    .dark-theme .card-header {
        background-color: rgba(0, 0, 0, 0.2);
        border-color: var(--border-color);
    }
    .dark-theme .table {
        color: var(--body-color);
    }
    .dark-theme .table > thead {
        background-color: var(--table-header-bg);
    }
    .dark-theme .table td, .dark-theme .table th {
        border-color: var(--border-color);
    }
    .dark-theme .quick-actions .card {
        background-color: var(--card-bg);
        color: var(--body-color);
    }
    .dark-theme .quick-actions .card-text {
        color: var(--body-color);
    }
    /* æœ€è¿‘æ–‡ç« è¡¨æ ¼æ ·å¼ */
    .recent-posts-table {
        margin-bottom: 0;
    }
    .dark-theme .recent-posts-table tbody tr {
        border-color: var(--border-color);
    }
    .dark-theme .recent-posts-table tbody tr:hover {
        background-color: rgba(255, 255, 255, 0.05);
    }
</style>

</head>
<body>
    <!-- ç§»åŠ¨è®¾å¤‡ä¾§è¾¹æ åˆ‡æ¢æŒ‰é’® -->
    <div class="d-md-none mb-3 px-3">
        <button class="btn btn-primary" id="sidebarToggle">
            <i class="bi bi-list"></i> èœå•
        </button>
    </div>
    
    <!-- ä¾§è¾¹æ èƒŒæ™¯é®ç½© -->
    <div class="sidebar-backdrop" id="sidebarBackdrop"></div>
    
    <div class="container-fluid">
        <div class="row">
            <!-- ä¾§è¾¹æ  -->
            <nav id="sidebar" class="col-md-3 col-lg-2 d-md-block bg-dark sidebar">
                <div class="position-sticky pt-3">
                    <div class="text-center mb-4">
                        <h5 class="text-white">åšå®¢ç®¡ç†ç³»ç»Ÿ</h5>
                    </div>
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link " href="/admin/">
                                <i class="bi bi-house-door"></i> é¦–é¡µ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link " href="/admin/post/">
                                <i class="bi bi-file-earmark-text"></i> æ–‡ç« ç®¡ç†
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link " href="/admin/category/">
                                <i class="bi bi-folder"></i> åˆ†ç±»ç®¡ç†
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link " href="/admin/tag/">
                                <i class="bi bi-tags"></i> æ ‡ç­¾ç®¡ç†
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link " href="/admin/comment/">
                                <i class="bi bi-chat-dots"></i> è¯„è®ºç®¡ç†
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link " href="/admin/user/">
                                <i class="bi bi-people"></i> ç”¨æˆ·ç®¡ç†
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link " href="/admin/profile">
                                <i class="bi bi-person"></i> ä¸ªäººèµ„æ–™
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link " href="/admin/settings/">
                                <i class="bi bi-gear"></i> ç³»ç»Ÿè®¾ç½®
                            </a>
                        </li>
                    </ul>
                    <hr class="text-white">
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="/blog/" target="_blank">
                                <i class="bi bi-box-arrow-up-right"></i> æŸ¥çœ‹ç½‘ç«™
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link theme-toggle" href="javascript:void(0);" title="åˆ‡æ¢ä¸»é¢˜">
                                <i class="bi bi-moon-fill theme-toggle-icon"></i> åˆ‡æ¢ä¸»é¢˜
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/auth/logout">
                                <i class="bi bi-box-arrow-right"></i> é€€å‡º
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- ä¸»å†…å®¹åŒº -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">ç®¡ç†åå°</h1>
                    <div class="btn-toolbar mb-2 mb-md-0">
                        <div class="btn-group me-2">
                            
                        </div>
                        <!-- ä¸»é¢˜åˆ‡æ¢æŒ‰é’®ï¼ˆå¤§å±å¹•æ˜¾ç¤ºï¼‰ -->
                        <button class="btn btn-sm btn-outline-secondary theme-toggle d-none d-md-block" title="åˆ‡æ¢ä¸»é¢˜">
                            <i class="bi bi-moon-fill theme-toggle-icon"></i>
                        </button>
                    </div>
                </div>

                <!-- æ¶ˆæ¯æç¤º -->
                
                    
                

                <!-- ä¸»è¦å†…å®¹ -->
                
<div class="container-fluid py-4">
    <div class="row">
        <div class="col-12">
            <div class="card mb-4">
                <div class="card-header pb-0">
                    <h6>ç®¡ç†åå°é¦–é¡µ</h6>
                </div>
                <div class="card-body px-0 pt-0 pb-2">
                    <div class="p-4">
                        <h2>æ¬¢è¿å›æ¥ï¼Œ</h2>
                        <p>æ‚¨å¯ä»¥é€šè¿‡å·¦ä¾§èœå•ç®¡ç†åšå®¢å†…å®¹ã€‚</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ç»Ÿè®¡å¡ç‰‡ -->
    <div class="row mb-4">
        <div class="col-md-3 mb-3">
            <div class="card bg-primary text-white">
                <div class="card-body text-center">
                    <div class="card-icon">ğŸ“</div>
                    <h5 class="card-title">æ–‡ç« æ€»æ•°</h5>
                    <h2></h2>
                </div>
            </div>
        </div>
        <div class="col-md-3 mb-3">
            <div class="card bg-success text-white">
                <div class="card-body text-center">
                    <div class="card-icon">ğŸ“¢</div>
                    <h5 class="card-title">å·²å‘å¸ƒ</h5>
                    <h2></h2>
                </div>
            </div>
        </div>
        <div class="col-md-3 mb-3">
            <div class="card bg-warning text-white">
                <div class="card-body text-center">
                    <div class="card-icon">ğŸ“‹</div>
                    <h5 class="card-title">è‰ç¨¿</h5>
                    <h2></h2>
                </div>
            </div>
        </div>
        <div class="col-md-3 mb-3">
            <div class="card bg-info text-white">
                <div class="card-body text-center">
                    <div class="card-icon">ğŸ·ï¸</div>
                    <h5 class="card-title">æ ‡ç­¾</h5>
                    <h2></h2>
                </div>
            </div>
        </div>
    </div>

    <!-- å¿«é€Ÿæ“ä½œ -->
    <div class="row mb-4">
        <div class="col-md-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">å¿«é€Ÿæ“ä½œ</h5>
                </div>
                <div class="card-body">
                    <div class="row quick-actions">
                        <div class="col-md-4 mb-4">
                            <div class="card h-100">
                                <div class="card-body text-center">
                                    <i class="bi bi-file-earmark-plus display-4 mb-3 text-primary"></i>
                                    <h5 class="card-title">å†™æ–‡ç« </h5>
                                    <p class="card-text">åˆ›å»ºæ–°çš„åšå®¢æ–‡ç« </p>
                                    <a href="/admin/post/create" class="btn btn-outline-primary btn-lg w-100">
                                        <i class="bi bi-pencil-square"></i> å¼€å§‹å†™ä½œ
                                    </a>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 mb-4">
                            <div class="card h-100">
                                <div class="card-body text-center">
                                    <i class="bi bi-folder-plus display-4 mb-3 text-success"></i>
                                    <h5 class="card-title">æ·»åŠ åˆ†ç±»</h5>
                                    <p class="card-text">åˆ›å»ºæ–°çš„æ–‡ç« åˆ†ç±»</p>
                                    <a href="/admin/category/create" class="btn btn-outline-success btn-lg w-100">
                                        <i class="bi bi-plus-circle"></i> åˆ›å»ºåˆ†ç±»
                                    </a>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 mb-4">
                            <div class="card h-100">
                                <div class="card-body text-center">
                                    <i class="bi bi-tag display-4 mb-3 text-info"></i>
                                    <h5 class="card-title">æ·»åŠ æ ‡ç­¾</h5>
                                    <p class="card-text">åˆ›å»ºæ–°çš„æ–‡ç« æ ‡ç­¾</p>
                                    <a href="/admin/tag/create" class="btn btn-outline-info btn-lg w-100">
                                        <i class="bi bi-plus-circle"></i> åˆ›å»ºæ ‡ç­¾
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- æœ€è¿‘æ–‡ç«  -->
    <div class="row">
        <div class="col-md-12">
            <div class="card mb-4">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <div>
                        <i class="bi bi-file-text me-1"></i>
                        æœ€è¿‘æ–‡ç« 
                    </div>
                    <a href="/admin/post/" class="btn btn-sm btn-primary">æŸ¥çœ‹å…¨éƒ¨</a>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table recent-posts-table table-hover mb-0">
                            <thead>
                                <tr>
                                    <th>æ ‡é¢˜</th>
                                    <th>å‘å¸ƒæ—¥æœŸ</th>
                                    <th>çŠ¶æ€</th>
                                    <th>é˜…è¯»æ¬¡æ•°</th>
                                    <th>æ“ä½œ</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- æ–‡ç« åˆ—è¡¨ -->
                                <!-- 
                                DEBUGä¿¡æ¯:
                                recent_postsé•¿åº¦: 0
                                
                                END DEBUG
                                -->
                                
                                    <tr>
                                        <td colspan="5" class="text-center py-3">æš‚æ— æ–‡ç« </td>
                                    </tr>
                                
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

            </main>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.2.1/dist/chart.umd.min.js"></script>
    <script src="/static/js/admin.js"></script>
    <!-- ä¸»é¢˜åˆ‡æ¢è„šæœ¬ -->
    <script src="/static/js/theme-switcher.js"></script>
    
    <!-- ä¾§è¾¹æ åˆ‡æ¢è„šæœ¬ -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const sidebar = document.getElementById('sidebar');
            const sidebarToggle = document.getElementById('sidebarToggle');
            const sidebarBackdrop = document.getElementById('sidebarBackdrop');
            
            // åˆ‡æ¢ä¾§è¾¹æ 
            sidebarToggle.addEventListener('click', function() {
                sidebar.classList.toggle('show');
                sidebarBackdrop.classList.toggle('show');
            });
            
            // ç‚¹å‡»èƒŒæ™¯é®ç½©å…³é—­ä¾§è¾¹æ 
            sidebarBackdrop.addEventListener('click', function() {
                sidebar.classList.remove('show');
                sidebarBackdrop.classList.remove('show');
            });
            
            // ç‚¹å‡»ä¾§è¾¹æ é“¾æ¥åå…³é—­ä¾§è¾¹æ ï¼ˆåœ¨ç§»åŠ¨è®¾å¤‡ä¸Šï¼‰
            const sidebarLinks = sidebar.querySelectorAll('a.nav-link');
            sidebarLinks.forEach(link => {
                link.addEventListener('click', function() {
                    if (window.innerWidth < 768) {
                        sidebar.classList.remove('show');
                        sidebarBackdrop.classList.remove('show');
                    }
                });
            });
        });
    </script>
    
    <!-- å¼•å…¥åŸºç¡€è„šæœ¬ -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/static/js/fetch-utils.js"></script>
    

<script>
    // ç®€å•è„šæœ¬ï¼Œä»…ç”¨äºè°ƒè¯•
    console.log("ç®¡ç†åå°é¦–é¡µåŠ è½½å®Œæˆ");
    
    // åç«¯æŸ¥è¯¢é—®é¢˜è°ƒè¯•ä¿¡æ¯
    console.log("JSè°ƒè¯•: æ£€æŸ¥æ¸²æŸ“æ¨¡æ¿æ—¶ä¼ é€’çš„æ•°æ®");
    
    
    console.log("JSè°ƒè¯•: åç«¯æ²¡æœ‰ä¼ é€’æ–‡ç« æ•°æ®");
    
    
    // å®šæ—¶åˆ·æ–°ç»Ÿè®¡æ•°æ®
    function refreshStats() {
        console.log("å°è¯•åˆ·æ–°ç»Ÿè®¡æ•°æ®");
        // ä½¿ç”¨fetch APIè·å–æœ€æ–°ç»Ÿè®¡æ•°æ®
        fetch('/admin/get_stats')
            .then(response => {
                if (!response.ok) {
                    throw new Error('ç½‘ç»œå“åº”å¼‚å¸¸');
                }
                return response.json();
            })
            .then(data => {
                console.log("è·å–åˆ°ç»Ÿè®¡æ•°æ®:", data);
                
                // æ›´æ–°ç»Ÿè®¡æ•°æ®
                document.querySelectorAll(".row.mb-4 .col-md-3").forEach(function(el, index) {
                    const title = el.querySelector(".card-title").textContent.trim();
                    const valueElement = el.querySelector("h2");
                    
                    if (title === "æ–‡ç« æ€»æ•°") {
                        valueElement.textContent = data.post_count;
                    } else if (title === "å·²å‘å¸ƒ") {
                        valueElement.textContent = data.published_count;
                    } else if (title === "è‰ç¨¿") {
                        valueElement.textContent = data.draft_count;
                    } else if (title === "æ ‡ç­¾") {
                        valueElement.textContent = data.tag_count;
                    }
                });
                
                console.log("ç»Ÿè®¡æ•°æ®å·²æ›´æ–°");
            })
            .catch(error => {
                console.error('è·å–ç»Ÿè®¡æ•°æ®å¤±è´¥:', error);
            });
    }
    
    // æ¯30ç§’åˆ·æ–°ä¸€æ¬¡æ•°æ®
    setInterval(refreshStats, 30000);
    
    // é¡µé¢åŠ è½½åç«‹å³åˆ·æ–°ä¸€æ¬¡æ•°æ®
    document.addEventListener('DOMContentLoaded', function() {
        // å»¶è¿Ÿä¸€ç§’æ‰§è¡Œï¼Œç¡®ä¿é¡µé¢å®Œå…¨åŠ è½½
        setTimeout(refreshStats, 1000);
    });
</script>

    
    <!-- Toastæç¤ºå®¹å™¨ -->
    <div class="toast-container position-fixed bottom-0 end-0 p-3">
        <!-- åŠ¨æ€æ·»åŠ çš„Toastæ¶ˆæ¯å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ -->
    </div>
</body>
</html> 